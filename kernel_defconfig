#
# Minimal ARM64 kernel config: Cortex-A53 Ã—2, initramfs, single UART
#

CONFIG_ARM64=y
CONFIG_ARCH_VIRT=y
CONFIG_NR_CPUS=2
CONFIG_SMP=y
CONFIG_GENERIC_CPU=y
CONFIG_HAVE_ARM_SMCCC=y

# if use initramfs need these macros
# CONFIG_BLK_DEV_INITRD is not set
# CONFIG_RD_GZIP is not set

# Device Tree
CONFIG_OF=y
CONFIG_OF_FLATTREE=y
CONFIG_OF_ADDRESS=y
CONFIG_OF_EARLY_FLATTREE=y
CONFIG_ARM_PSCI_FW=y

# CPU erratum workarounds for Cortex-A53
CONFIG_ARM64_ERRATUM_845719=y

# Serial console
CONFIG_SERIAL_AMBA_PL011=y
CONFIG_SERIAL_AMBA_PL011_CONSOLE=y
CONFIG_LEGACY_PTYS=n

# no other serial drivers
CONFIG_SERIAL_8250_PCI=no

# Filesystems
CONFIG_TMPFS=y
CONFIG_TMPFS_POSIX_ACL=y
CONFIG_DEVTMPFS=y
CONFIG_PROC_FS=y
CONFIG_SYSFS=y
CONFIG_DEBUG_FS=y
CONFIG_EXT2_FS=y
CONFIG_EXT4_FS=y
CONFIG_BLK_DEV_SD=y

# No block devices
CONFIG_BLK_DEV_RAM=n
CONFIG_BLK_DEV_LOOP=n
CONFIG_MSDOS_PARTITION=n
CONFIG_FAT_FS=n
CONFIG_BTRFS_FS=n
CONFIG_NFS_FS=n
CONFIG_ISO9660_FS=n

# QEMU virtio
CONFIG_VIRTIO=y
CONFIG_VIRTIO_MMIO=y

# Network configs
CONFIG_NET=y
CONFIG_NETDEVICES=y
CONFIG_PACKET=y
CONFIG_INET=y
CONFIG_VIRTIO_NET=y
CONFIG_UNIX=y
CONFIG_IP_PNP=y
CONFIG_IP_PNP_DHCP=y
CONFIG_BRIDGE=n
CONFIG_CAN=n

# No I2C, SPI, MMC, sound, video, input, crypto modules
CONFIG_I2C=n
CONFIG_SPI=n
CONFIG_MMC=n
CONFIG_SOUND=n
CONFIG_DRM=n
CONFIG_INPUT=y
CONFIG_INPUT_MISC=n
CONFIG_HW_RANDOM=n
CONFIG_CRYPTO=n

CONFIG_PCI=y
CONFIG_PCI_HOST_GENERIC=y

CONFIG_SCSI=y

CONFIG_USB=y
CONFIG_USB_SUPPORT=y
CONFIG_USB_COMMON=y
CONFIG_USB_XHCI_HCD=y
CONFIG_USB_XHCI_PCI=y
CONFIG_USB_STORAGE=y

# Essential kernel features
CONFIG_KALLSYMS=y
CONFIG_PRINTK=y
CONFIG_PRINTK_TIME=y
CONFIG_CONSOLE_LOGLEVEL_DEFAULT=7
CONFIG_LOG_BUF_SHIFT=17

# CONFIG_MODULES is not set
# CONFIG_MODULE_UNLOAD is not set

# Scheduler, power, timers, but no ACPI/DT specific power management
CONFIG_HIGH_RES_TIMERS=y
CONFIG_ARM_GIC=y
